!function(e){"use strict";e(function(){function s(s,t){var i=e("#need_update"),m=e(".md-message.md-update"),l={action:"monstroid_dashboard_do_theme_update",nonce:monstroid_dashboard.nonce};return s.hasClass("in-progress")||s.hasClass("disabled")?!1:(s.addClass("in-progress"),o(s,"success"),e(".md-misc-messages").addClass("md-hidden"),n(),1==t&&(l.ignore_backup=!0,o(e(".md-update-messages"),"dark")),void e.ajax({url:ajaxurl,type:"post",dataType:"json",data:l,error:function(){s.removeClass("in-progress"),r(s),a(monstroid_dashboard.internal_error)}}).done(function(n){return s.removeClass("in-progress"),r(s),1==n.success?(s.addClass("md-hidden"),i.length>0&&i.addClass("md-hidden"),m.length>0&&m.addClass("md-hidden"),a(n.data.message,"success"),d(n.data.update_log),e(".md-new-version").text(n.data.new_version),e(".md-badge").remove(),1):0==n.success&&"backup_failed"==n.data.type?(a(n.data.message),d(n.data.update_log),s.addClass("md-hidden"),!1):(a(n.data.message),void d(n.data.update_log))}))}function a(s,a){a="undefined"!=typeof a?a:"default",e(".md-update-messages").addClass("md-"+a).html(s)}function d(s){e(".md-update-log").html(s)}function n(){e(".md-update-messages").attr("class","md-update-messages").empty(),e(".md-update-log").empty().addClass("md-hidden")}function o(e,s){e.prepend('<span class="md-spinner md-'+s+'"><span class="md-spinner-circle"></span></span>')}function r(s){e(".md-spinner",s).remove()}e(document).on("click",".run-theme-update",function(a){return a.preventDefault(),confirm(monstroid_dashboard.confirm_update)?void s(e(this),!1):!1}),e(document).on("click",".force-run-theme-update",function(a){a.preventDefault(),s(e(this),!0)}),e(document).on("click",".show-update-log",function(s){s.preventDefault(),e(".md-update-log").removeClass("md-hidden")}),e(document).on("click",".download-latest",function(s){s.preventDefault();var a=e(this);a.addClass("in-progress"),o(a,"default"),e(".md-download-message").remove(),e.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"monstroid_dashboard_download_latest",nonce:monstroid_dashboard.nonce},error:function(){a.removeClass("in-progress"),r(a),a.after('<div class="md-download-message md-error">'+monstroid_dashboard.internal_error+"</div>")}}).done(function(e){return a.removeClass("in-progress"),r(a),1==e.success?(window.location=e.data.url,1):void a.after('<div class="md-download-message md-error">'+e.data.message+"</div>")})}),e(document).on("click",".save-license-key",function(s){s.preventDefault();var a,d=e(this),n=e('input[name="monstroid-key"]');return d.hasClass("in-progress")?!1:(d.addClass("in-progress"),o(d,"default"),a=n.val(),e(".md-form-message").remove(),""==a?(n.addClass("error").parent().append('<div class="md-form-message md-error">'+monstroid_dashboard.empty_key+"</div>"),d.removeClass("in-progress"),r(d),!1):void e.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"monstroid_dashboard_save_key",key:a,nonce:monstroid_dashboard.nonce},error:function(){d.removeClass("in-progress"),r(d),n.parent().append('<div class="md-form-message md-error">'+monstroid_dashboard.internal_error+"</div>")}}).done(function(e){d.removeClass("in-progress"),r(d),n.parent().append(1==e.success?'<div class="md-form-message md-success">'+e.data.message+"</div>":'<div class="md-form-message md-error">'+e.data.message+"</div>")}))}),e(document).on("click",".md-updates-list_delete_link",function(e){confirm(monstroid_dashboard.confirm_delete)||e.preventDefault()}),e(document).on("click",".install-child",function(s){s.preventDefault();var a=e(this),d=a.data("template");return a.hasClass("in-progress")?!1:(a.addClass("in-progress"),o(a,"default"),void e.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"monstroid_dashboard_theme_install",template_id:d,nonce:monstroid_dashboard.nonce},error:function(){a.removeClass("in-progress").addClass("md-error-icon"),r(a)}}).done(function(e){a.removeClass("in-progress"),r(a),"success"==e.type?window.location=md_wizard_steps.install_theme:a.addClass("md-error-icon")}))}),e(document).on("click",".md-themes_pager_link",function(s){s.preventDefault();var a=e(this),d=e(".md-themes_content"),n=a.data("page");return a.hasClass("disabled")||a.hasClass("current-page")||a.hasClass("in-progress")?!1:(a.addClass("in-progress"),void e.ajax({url:ajaxurl,type:"post",dataType:"html",data:{action:"monstroid_dashboard_get_themes_page",page:n}}).done(function(e){a.removeClass("in-progress"),d.html(e)}))})})}(jQuery);